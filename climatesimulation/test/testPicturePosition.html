
<!DOCTYPE html>
<html>
<head>
<title>cannon.js - callbacks demo</title>
<meta charset="utf-8">

<meta name="viewport"
	content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
<script src="assets/cannon.js"></script>
<script src="assets/cannon.demo.js"></script>
<script src="assets/dat.gui.js"></script>
<script src="assets/Three.js"></script>
<script src="assets/TrackballControls.js"></script>
<script src="assets/Detector.js"></script>
<script src="assets/Stats.js"></script>
<script src="assets/smoothie.js"></script>
</head>
<body>



	<canvas id="earthCanvas"></canvas>
	<script>
    

	var myCanvas = document.getElementById('earthCanvas');
	var ctx = myCanvas.getContext('2d');
	var img = new Image;
	pData = []
	img.crossOrigin=null;
	
	img.onload = function(){
   	
	  myCanvas.height = img.height;
	  myCanvas.width = img.width;
	  ctx.drawImage(img,0,0); // Or at whatever offset you like
	  	for(a = 0; a < myCanvas.width; a+=32){
		for(b = 0; b < myCanvas.height; b+=32){
			var pixelData = ctx.getImageData(a, b, 1, 1).data;
			//a = u b = x or maybe reverse
			x = Math.sin((a + .5) * 3.14)
			y = Math.sin((b - .5) * 3.14)
			z = Math.sin((b - .5) * 3.14)
			pData.push([x,y,z,pixelData])
		}
	}
	console.log(pData)  
	
	var demo = new CANNON.Demo();

demo.addScene("Moon", function() {
	world = demo.getWorld();
	// world.broadphase = new CANNON.SAPBroadphase();
	world.solver.iterations = 1;
	world.allowSleep = true;
	// world.allowSleep = false;


	pCount = 0;
	interval = setInterval(function() {
		var cD = pData[pCount];
		var pShape = new CANNON.Sphere(0.1);
		var p = new CANNON.Body({
			mass : 5
		});
		p.addShape(pShape);
	
		p.position.set(cD[0]*5, cD[1]*5, cD[2]*5);
		colorD = 0x010000 * cd[3][0]+0x000100 * cd[3][1]+0x000001 * cd[3][2]
		p.linearDamping = 0.0;
		world.add(p);
		demo.addVisual(p, new THREE.MeshLambertMaterial({
			color : colorD
		}));
		

	}, 30);


});

demo.start();
	
	};
	img.src = "flatearth.jpg";    
	
	
	
	

  
    	//
    	
		//group by Y axis
		//make sun rotate around x axis (if it doesn't)
		//show Y axis correlation


    </script>
</body>
</html>
