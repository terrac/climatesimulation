
<!DOCTYPE html>
<html>
<head>
<title>cannon.js - callbacks demo</title>
<meta charset="utf-8">

<meta name="viewport"
	content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
<script src="assets/cannon.js"></script>
<script src="assets/cannon.demo.js"></script>
<script src="assets/dat.gui.js"></script>
<script src="assets/Three.js"></script>
<script src="assets/TrackballControls.js"></script>
<script src="assets/Detector.js"></script>
<script src="assets/Stats.js"></script>
<script src="assets/smoothie.js"></script>


<!-- <script src="intermediate.js"></script> -->

</head>
<body>




	<script>
function runEarth(){    
    pData = []
    radius = 5
	for(c = 0; c < intermediate.length; c++){
        var b = intermediate[c][0];
        var a = intermediate[c][1];
        var colors = intermediate[c][2];
        
		length = Math.sqrt(a * a + b * b);
		
		// normalize vector
		a /= length;
		b /= length;
        
        theta = 2 * Math.PI * a
        phi = Math.PI * b
        
        
		//x = Math.cos(a) * Math.cos(b) * radius;
		//y = Math.cos(a) * Math.sin(b) * radius;
		//z = Math.sin(a) * radius;
		
		x = Math.cos(theta) * Math.sin(phi) * radius;
		y = Math.sin(theta) * Math.sin(phi) * radius;
		z = -Math.cos(phi) * radius;
		
		
		pData.push([x,y,z,colors])
	}  
	
	var demo = new CANNON.Demo();

demo.addScene("Moon", function() {
	world = demo.getWorld();
	// world.broadphase = new CANNON.SAPBroadphase();
	world.solver.iterations = 1;
	world.allowSleep = true;
	// world.allowSleep = false;


	pCount = 0;
	interval = setInterval(function() {
		for(a = 0; a < 100000; a++){
		
			if(pCount >= pData.length){
				clearInterval(interval)
				return;
				demo.bodies.sort(function(b,a) {
				  var x = a.position.x - b.position.x;				  
				  return x == 0? a.position.z - b.position.z : x;
				});
				for(ind in demo.bodies){
					var col=pData[ind][3]
					colorD = 0x010000 * col[0]+0x000100 * col[1]+0x000001 * col[2]
					var vis=demo.getVisual(demo.bodies[ind])
					vis.material= new THREE.MeshLambertMaterial({
						color : colorD
					});
				}
				return;	
			}
			
			var cD = pData[pCount];
			var pShape = new CANNON.Sphere(0.1);
			var p = new CANNON.Body({
				mass : 5
			});
			p.addShape(pShape);
		
			p.position.set(cD[0], cD[1], cD[2]);
			colorD = 0x010000 * cD[3][0]+0x000100 * cD[3][1]+0x000001 * cD[3][2]
			p.linearDamping = 0.0;
			world.add(p);
			demo.addVisual(p, new THREE.MeshLambertMaterial({
				color : colorD
			}));
			console.log(cD[0]+" "+ cD[1]+" "+ cD[2])
			console.log(cD[3])
			pCount++;
		}
	}, 1);

	freqCount = 1
	var intervFreq= setInterval(function() {
	demo.settings.stepFrequency = freqCount * 6000
	freqCount++;
	if(freqCount > 5000){
		clearInterval(intervFreq);
	}
}, 100)

});

demo.start();
}	
	
	
	
	

  
    	//
    	
		//group by Y axis
		//make sun rotate around x axis (if it doesn't)
		//show Y axis correlation


    </script>
	<canvas id="earthCanvas"></canvas>
	<script src="loadingImage.js"></script>
</body>
</html>
